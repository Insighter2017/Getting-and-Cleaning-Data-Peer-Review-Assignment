# Cookbook - Smartphone Human Activity Recognition
### Submitted for Coursera Getting and Cleaning Data Project
### Prepared by Shelby Brambach
### Date: April 12, 2017

## Requirements:

Exhibit your ability to collect, work with, and clean a data set. 
Prepare tidy data that can be used for later analysis. 
You will be graded by your peers on a series of yes/no questions related to the project. 

## Submit the following: 
1) Two separate tidy data sets
2) A link to your gitgub repository containing your run_analysis script
3) A code book that describes the variables, the data, and any transformations or work that you performed to clean up the data called CodeBook.md. 
4) Readme You should also include a README.md in the repo with your scripts. This repo explains how all of the scripts work and how they are connected.

## The run_analysis.R script must accomplist the following:

You should create one R script called run_analysis.R that does the following.
1. Merges the training and the test sets to create one data set.
2. Performs a series of tidy-related data manipulation to achieve a tidy data set
2. Creates and writes one tidy data set containing only the mean and standard deviation for each activity
3. Creates and writes a separate tidy data set containing only the average for each activity

## Citations

The data subset used for this class project is taken from the following source.

Project Data: https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip

##Data Set Citations

* Lichman, M. (2013). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. Irvine, CA: University of California, School of Information and Computer Science.

* BiBTeX citation: @misc{Lichman:2013, author = "M. Lichman", year = "2013", title = "{UCI} Machine Learning Repository", url = "http://archive.ics.uci.edu/ml", institution = "University of California, Irvine, School of Information and Computer Sciences" } 

## Design of Experiments: 
http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones


The features selected for this database come from the accelerometer and gyroscope 3-axial raw signals tAcc-XYZ and tGyro-XYZ. These time domain signals (prefix ‘t’ to denote time) were captured at a constant rate of 50 Hz. and the acceleration signal was then separated into body and gravity acceleration signals (tBodyAcc-XYZ and tGravityAcc-XYZ) – both using a low pass Butterworth filter.

The body linear acceleration and angular velocity were derived in time to obtain Jerk signals (tBodyAccJerk-XYZ and tBodyGyroJerk-XYZ). Also the magnitude of these three-dimensional signals were calculated using the Euclidean norm (tBodyAccMag, tGravityAccMag, tBodyAccJerkMag, tBodyGyroMag, tBodyGyroJerkMag).

A Fast Fourier Transform (FFT) was applied to some of these signals producing fBodyAcc-XYZ, fBodyAccJerk-XYZ, fBodyGyro-XYZ, fBodyAccJerkMag, fBodyGyroMag, fBodyGyroJerkMag. (Note the ‘f’ to indicate frequency domain signals).


## Description of abbreviations of measurements
1.leading t or f is based on time or frequency measurements.
2.Body = related to body movement.
3.Gravity = acceleration of gravity
4.Acc = accelerometer measurement
5.Gyro = gyroscopic measurements
6.Jerk = sudden movement acceleration
7.Mag = magnitude of movement
8.mean and SD are calculated for each subject for each activity for each mean and SD measurements.

## The units given are g’s for the accelerometer and rad/sec for the gyro and g/sec and rad/sec/sec for the corresponding jerks.

These signals were used to estimate variables of the feature vector for each pattern:
‘-XYZ’ is used to denote 3-axial signals in the X, Y and Z directions. They total 33 measurements including the 3 dimensions - the X,Y, and Z axes.
•tBodyAcc-XYZ
•tGravityAcc-XYZ
•tBodyAccJerk-XYZ
•tBodyGyro-XYZ
•tBodyGyroJerk-XYZ
•tBodyAccMag
•tGravityAccMag
•tBodyAccJerkMag
•tBodyGyroMag
•tBodyGyroJerkMag
•fBodyAcc-XYZ
•fBodyAccJerk-XYZ
•fBodyGyro-XYZ
•fBodyAccMag
•fBodyAccJerkMag
•fBodyGyroMag
•fBodyGyroJerkMag


The set of variables that were estimated from these signals are:
•mean(): Mean value
•std(): Standard deviation


## Experimental Design

The experiments have been carried out with a group of 30 volunteers within an age bracket of 19-48 years. Each person performed six activities (WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING) wearing a smartphone (Samsung Galaxy S II) on the waist. Using its embedded accelerometer and gyroscope, we captured 3-axial linear acceleration and 3-axial angular velocity at a constant rate of 50Hz. The experiments have been video-recorded to label the data manually. The obtained dataset has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data.

The sensor signals (accelerometer and gyroscope) were pre-processed by applying noise filters and then sampled in fixed-width sliding windows. From each window, a vector of features was obtained by calculating variables from the time and frequency domain.


## Walkthrough of run_analysis.R
 
Download the zip files from Coursera into your working directory.
setwd("C:/Users/Shelby/DataScienceCoursera/DataScienceCoursera/WearableTech/getdata_projectfiles_UCI HAR Dataset/UCI HAR Dataset")

### Step 1:  Create three data tables for the three test and training sets (X, subject, and y).

X1 <- read.table("train/X_train.txt")
X2 <- read.table("test/X_test.txt")

S1 <- read.table("train/subject_train.txt")
S2 <- read.table("test/subject_test.txt")

Y1 <- read.table("train/y_train.txt")
Y2 <- read.table("test/y_test.txt")

X <- rbind(X1, X2)
S <- rbind(S1, S2)
Y <- rbind(Y1, Y2)

### Step 2. Use grep to find -mean and -std, then strip those patterns from the description.  Perform text manipulations on indexed descriptions

features <- read.table("features.txt")
indices_features <- grep("-mean\\(\\)|-std\\(\\)", features[, 2])
	
	X <- X[, indices_features]
		names(X) <- features[indices_features, 2]
		names(X) <- gsub("\\(|\\)", "", names(X))
		names(X) <- tolower(names(X))


### Step 3. Tidy the activity names in the activity labels data set.

activities <- read.table("activity_labels.txt")

From activity_labels.txt, which contains factor labels for the various activities in the study, assign the name "activity" to the Y table.
activities[, 2] = gsub("_", "", tolower(as.character(activities[, 2])))
Y[,1] = activities[Y[,1], 2]
names(Y) <- "activity"

Apply name "subject" to the data table S
names(S) <- "subject"  
cleaned <- cbind(S, Y, X)


### Step 4.  Write to text file:  write.table(cleaned, "dataSet1_Mean_and_SD_Only.txt") #write the file to your directory


### Step 5. Create a 2nd, independent tidy data set with the average of each variable for each activity and each subject.
This uses nested functions to produce a cleaned data set that includes the subject, the activity, mean and SD for each activity.

uniqueSubjects = unique(S)[,1]
numSubjects = length(unique(S)[,1])
numActivities = length(activities[,1])
numCols = dim(cleaned)[2]
result = cleaned[1:(numSubjects*numActivities), ]
row = 1

for (s in 1:numSubjects) {
for (a in 1:numActivities) {
result[row, 1] = uniqueSubjects[s]
result[row, 2] = activities[a, 2]
tmp <- cleaned[cleaned$subject==s & cleaned$activity==activities[a, 2], ]
result[row, 3:numCols] <- colMeans(tmp[, 3:numCols])
row = row+1
}
}

### Step 6:  Write second data set to file.  write.table(result, "dataSet2_averages.txt")

## Output from "dataSet1_Mean_and_SD_Only.txt"

> head(str(d1))  #This is the the data set containing mean and standard deviation
'data.frame':   10299 obs. of  563 variables:
 $ subject                  : int  1 1 1 1 1 1 1 1 1 1 ...
 $ activity                 : Factor w/ 6 levels "laying","sitting",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ tbodyacc.mean.x          : num  0.289 0.278 0.28 0.279 0.277 ...
 $ tbodyacc.mean.y          : num  -0.0203 -0.0164 -0.0195 -0.0262 -0.0166 ...
 $ tbodyacc.mean.z          : num  -0.133 -0.124 -0.113 -0.123 -0.115 ...
 $ tbodyacc.std.x           : num  -0.995 -0.998 -0.995 -0.996 -0.998 ...
 $ tbodyacc.std.y           : num  -0.983 -0.975 -0.967 -0.983 -0.981 ...
 $ tbodyacc.std.z           : num  -0.914 -0.96 -0.979 -0.991 -0.99 ...
 $ tgravityacc.mean.x       : num  -0.995 -0.999 -0.997 -0.997 -0.998 ...
 $ tgravityacc.mean.y       : num  -0.983 -0.975 -0.964 -0.983 -0.98 ...
 $ tgravityacc.mean.z       : num  -0.924 -0.958 -0.977 -0.989 -0.99 ...
 $ tgravityacc.std.x        : num  -0.935 -0.943 -0.939 -0.939 -0.942 ...
 $ tgravityacc.std.y        : num  -0.567 -0.558 -0.558 -0.576 -0.569 ...
 $ tgravityacc.std.z        : num  -0.744 -0.818 -0.818 -0.83 -0.825 ...
 $ tbodyaccjerk.mean.x      : num  0.853 0.849 0.844 0.844 0.849 ...
 $ tbodyaccjerk.mean.y      : num  0.686 0.686 0.682 0.682 0.683 ...
 $ tbodyaccjerk.mean.z      : num  0.814 0.823 0.839 0.838 0.838 ...
 $ tbodyaccjerk.std.x       : num  -0.966 -0.982 -0.983 -0.986 -0.993 ...
 $ tbodyaccjerk.std.y       : num  -1 -1 -1 -1 -1 ...
 $ tbodyaccjerk.std.z       : num  -1 -1 -1 -1 -1 ...
 $ tbodygyro.mean.x         : num  -0.995 -0.998 -0.999 -1 -1 ...
 $ tbodygyro.mean.y         : num  -0.994 -0.999 -0.997 -0.997 -0.998 ...
 $ tbodygyro.mean.z         : num  -0.988 -0.978 -0.965 -0.984 -0.981 ...
 $ tbodygyro.std.x          : num  -0.943 -0.948 -0.975 -0.986 -0.991 ...
 $ tbodygyro.std.y          : num  -0.408 -0.715 -0.592 -0.627 -0.787 ...
 $ tbodygyro.std.z          : num  -0.679 -0.501 -0.486 -0.851 -0.559 ...
 $ tbodygyrojerk.mean.x     : num  -0.602 -0.571 -0.571 -0.912 -0.761 ...
 $ tbodygyrojerk.mean.y     : num  0.9293 0.6116 0.273 0.0614 0.3133 ...
 $ tbodygyrojerk.mean.z     : num  -0.853 -0.3295 -0.0863 0.0748 -0.1312 ...
 $ tbodygyrojerk.std.x      : num  0.36 0.284 0.337 0.198 0.191 ...
 $ tbodygyrojerk.std.y      : num  -0.0585 0.2846 -0.1647 -0.2643 0.0869 ...
 $ tbodygyrojerk.std.z      : num  0.2569 0.1157 0.0172 0.0725 0.2576 ...
 $ tbodyaccmag.mean         : num  -0.2248 -0.091 -0.0745 -0.1553 -0.2725 ...
 $ tbodyaccmag.std          : num  0.264 0.294 0.342 0.323 0.435 ...
 $ tgravityaccmag.mean      : num  -0.0952 -0.2812 -0.3326 -0.1708 -0.3154 ...
 $ tgravityaccmag.std       : num  0.279 0.086 0.239 0.295 0.44 ...
 $ tbodyaccjerkmag.mean     : num  -0.4651 -0.0222 -0.1362 -0.3061 -0.2691 ...
 $ tbodyaccjerkmag.std      : num  0.4919 -0.0167 0.1739 0.4821 0.1794 ...
 $ tbodygyromag.mean        : num  -0.191 -0.221 -0.299 -0.47 -0.089 ...
 $ tbodygyromag.std         : num  0.3763 -0.0134 -0.1247 -0.3057 -0.1558 ...
 $ tbodygyrojerkmag.mean    : num  0.4351 -0.0727 -0.1811 -0.3627 -0.1898 ...
 $ tbodygyrojerkmag.std     : num  0.661 0.579 0.609 0.507 0.599 ...
 $ fbodyacc.mean.x          : num  0.963 0.967 0.967 0.968 0.968 ...
 $ fbodyacc.mean.y          : num  -0.141 -0.142 -0.142 -0.144 -0.149 ...
 $ fbodyacc.mean.z          : num  0.1154 0.1094 0.1019 0.0999 0.0945 ...
 $ fbodyacc.std.x           : num  -0.985 -0.997 -1 -0.997 -0.998 ...
 $ fbodyacc.std.y           : num  -0.982 -0.989 -0.993 -0.981 -0.988 ...
 $ fbodyacc.std.z           : num  -0.878 -0.932 -0.993 -0.978 -0.979 ...
 $ fbodyaccjerk.mean.x      : num  -0.985 -0.998 -1 -0.996 -0.998 ...
 $ fbodyaccjerk.mean.y      : num  -0.984 -0.99 -0.993 -0.981 -0.989 ...
 $ fbodyaccjerk.mean.z      : num  -0.895 -0.933 -0.993 -0.978 -0.979 ...
 $ fbodyaccjerk.std.x       : num  0.892 0.892 0.892 0.894 0.894 ...
 $ fbodyaccjerk.std.y       : num  -0.161 -0.161 -0.164 -0.164 -0.167 ...
 $ fbodyaccjerk.std.z       : num  0.1247 0.1226 0.0946 0.0934 0.0917 ...
 $ fbodygyro.mean.x         : num  0.977 0.985 0.987 0.987 0.987 ...
 $ fbodygyro.mean.y         : num  -0.123 -0.115 -0.115 -0.121 -0.122 ...
 $ fbodygyro.mean.z         : num  0.0565 0.1028 0.1028 0.0958 0.0941 ...
 $ fbodygyro.std.x          : num  -0.375 -0.383 -0.402 -0.4 -0.4 ...
 $ fbodygyro.std.y          : num  0.899 0.908 0.909 0.911 0.912 ...
 $ fbodygyro.std.z          : num  -0.971 -0.971 -0.97 -0.969 -0.967 ...
 $ fbodyaccmag.mean         : num  -0.976 -0.979 -0.982 -0.982 -0.984 ...
 $ fbodyaccmag.std          : num  -0.984 -0.999 -1 -0.996 -0.998 ...
 $ fbodybodyaccjerkmag.mean : num  -0.989 -0.99 -0.992 -0.981 -0.991 ...
 $ fbodybodyaccjerkmag.std  : num  -0.918 -0.942 -0.993 -0.98 -0.98 ...
 $ fbodybodygyromag.mean    : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
 $ fbodybodygyromag.std     : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
 $ fbodybodygyrojerkmag.mean: num  0.114 -0.21 -0.927 -0.596 -0.617 ...
 $ fbodybodygyrojerkmag.std : num  -0.59042 -0.41006 0.00223 -0.06493 -0.25727 ...


## Output from "dataSet2_averages.txt"

> head(str(d2)) #This is the data set containing averages for each activity
'data.frame':   180 obs. of  563 variables:
 $ subject                  : int  1 1 1 1 1 1 3 3 3 3 ...
 $ activity                 : Factor w/ 6 levels "laying","sitting",..: 4 6 5 2 3 1 4 6 5 2 ...
 $ tbodyacc.mean.x          : num  0.277 0.255 0.289 0.261 0.279 ...
 $ tbodyacc.mean.y          : num  -0.01738 -0.02395 -0.00992 -0.00131 -0.01614 ...
 $ tbodyacc.mean.z          : num  -0.1111 -0.0973 -0.1076 -0.1045 -0.1106 ...
 $ tbodyacc.std.x           : num  -0.284 -0.355 0.03 -0.977 -0.996 ...
 $ tbodyacc.std.y           : num  0.11446 -0.00232 -0.03194 -0.92262 -0.97319 ...
 $ tbodyacc.std.z           : num  -0.26 -0.0195 -0.2304 -0.9396 -0.9798 ...
 $ tgravityacc.mean.x       : num  -0.3407 -0.4028 -0.0441 -0.9795 -0.9961 ...
 $ tgravityacc.mean.y       : num  0.06181 0.00768 -0.1074 -0.91966 -0.97176 ...
 $ tgravityacc.mean.z       : num  -0.25 0.036 -0.212 -0.939 -0.979 ...
 $ tgravityacc.std.x        : num  -0.103 -0.159 0.389 -0.927 -0.939 ...
 $ tgravityacc.std.y        : num  -0.0557 -0.1027 -0.0953 -0.5174 -0.5609 ...
 $ tgravityacc.std.z        : num  -0.255 -0.161 -0.317 -0.786 -0.813 ...
 $ tbodyaccjerk.mean.x      : num  0.1196 0.2382 0.0157 0.8203 0.8489 ...
 $ tbodyaccjerk.mean.y      : num  -0.0212 0.144 -0.0437 0.6828 0.685 ...
 $ tbodyaccjerk.mean.z      : num  0.437 0.442 0.305 0.822 0.838 ...
 $ tbodyaccjerk.std.x       : num  -0.1258 -0.0968 0.008 -0.9457 -0.9844 ...
 $ tbodyaccjerk.std.y       : num  -0.739 -0.788 -0.463 -0.998 -1 ...
 $ tbodyaccjerk.std.z       : num  -0.758 -0.805 -0.813 -0.99 -0.999 ...
 $ tbodygyro.mean.x         : num  -0.748 -0.566 -0.724 -0.987 -0.999 ...
 $ tbodygyro.mean.y         : num  -0.424 -0.496 -0.225 -0.983 -0.996 ...
 $ tbodygyro.mean.z         : num  -0.299 -0.192 -0.399 -0.932 -0.974 ...
 $ tbodygyro.std.x          : num  -0.2525 0.0722 -0.2058 -0.9429 -0.9786 ...
 $ tbodygyro.std.y          : num  0.359 0.431 0.237 -0.594 -0.654 ...
 $ tbodygyro.std.z          : num  0.437 0.327 0.376 -0.399 -0.563 ...
 $ tbodygyrojerk.mean.x     : num  0.04237 -0.00647 0.16973 -0.5213 -0.58945 ...
 $ tbodygyrojerk.mean.y     : num  -0.335 -0.524 -0.395 0.152 0.297 ...
 $ tbodygyrojerk.mean.z     : num  0.3484 0.4386 0.3676 -0.0594 -0.1455 ...
 $ tbodygyrojerk.std.x      : num  -0.149 -0.24 -0.31 0.041 0.114 ...
 $ tbodygyrojerk.std.y      : num  0.07994 0.13434 0.2763 -0.00412 0.0807 ...
 $ tbodygyrojerk.std.z      : num  -0.167 -0.327 -0.121 0.169 0.185 ...
 $ tbodyaccmag.mean         : num  0.175 0.227 0.155 -0.129 -0.138 ...
 $ tbodyaccmag.std          : num  0.1678 0.04 0.0867 0.1851 0.1903 ...
 $ tgravityaccmag.mean      : num  -0.0514 0.0368 0.0377 -0.117 -0.0158 ...
 $ tgravityaccmag.std       : num  -0.1189 -0.4687 0.0804 0.2589 0.2799 ...
 $ tbodyaccjerkmag.mean     : num  0.1673 0.3076 0.0878 -0.1171 -0.1279 ...
 $ tbodyaccjerkmag.std      : num  0.00262 -0.16858 0.02916 0.08508 0.11685 ...
 $ tbodygyromag.mean        : num  -0.2752 0.0138 -0.2914 -0.0227 -0.1039 ...
 $ tbodygyromag.std         : num  -0.144 -0.387 -0.454 -0.403 0.128 ...
 $ tbodygyrojerkmag.mean    : num  -0.19123 -0.17701 -0.22554 -0.20119 -0.00543 ...
 $ tbodygyrojerkmag.std     : num  0.3802 0.1616 0.0757 0.1183 0.2883 ...
 $ fbodyacc.mean.x          : num  0.935 0.893 0.932 0.832 0.943 ...
 $ fbodyacc.mean.y          : num  -0.282 -0.362 -0.267 0.204 -0.273 ...
 $ fbodyacc.mean.z          : num  -0.0681 -0.0754 -0.0621 0.332 0.0135 ...
 $ fbodyacc.std.x           : num  -0.977 -0.956 -0.951 -0.968 -0.994 ...
 $ fbodyacc.std.y           : num  -0.971 -0.953 -0.937 -0.936 -0.981 ...
 $ fbodyacc.std.z           : num  -0.948 -0.912 -0.896 -0.949 -0.976 ...
 $ fbodyaccjerk.mean.x      : num  -0.977 -0.958 -0.951 -0.969 -0.994 ...
 $ fbodyaccjerk.mean.y      : num  -0.972 -0.954 -0.938 -0.938 -0.981 ...
 $ fbodyaccjerk.mean.z      : num  -0.95 -0.915 -0.898 -0.95 -0.977 ...
 $ fbodyaccjerk.std.x       : num  0.869 0.835 0.876 0.768 0.87 ...
 $ fbodyaccjerk.std.y       : num  -0.294 -0.365 -0.27 0.188 -0.288 ...
 $ fbodyaccjerk.std.z       : num  -0.0629 -0.0612 -0.0465 0.3319 0.0097 ...
 $ fbodygyro.mean.x         : num  0.947 0.898 0.936 0.843 0.961 ...
 $ fbodygyro.mean.y         : num  -0.26 -0.344 -0.256 0.205 -0.248 ...
 $ fbodygyro.mean.z         : num  -0.07849 -0.09441 -0.0863 0.32184 0.00938 ...
 $ fbodygyro.std.x          : num  -0.1418 0.0141 -0.2063 0.2253 -0.2439 ...
 $ fbodygyro.std.y          : num  0.826 0.719 0.817 0.575 0.846 ...
 $ fbodygyro.std.z          : num  -0.864 -0.77 -0.879 -0.88 -0.862 ...
 $ fbodyaccmag.mean         : num  -0.986 -0.985 -0.988 -0.779 -0.995 ...
 $ fbodyaccmag.std          : num  -0.978 -0.962 -0.953 -0.972 -0.994 ...
 $ fbodybodyaccjerkmag.mean : num  -0.973 -0.957 -0.941 -0.944 -0.981 ...
 $ fbodybodyaccjerkmag.std  : num  -0.955 -0.924 -0.907 -0.954 -0.978 ...
 $ fbodybodygyromag.mean    : num  -0.667 -0.288 -0.445 -0.686 -0.886 ...
 $ fbodybodygyromag.std     : num  -1 -1 -1 -0.489 -1 ...
 $ fbodybodygyrojerkmag.mean: num  -0.993 -1 -0.98 -0.626 -0.852 ...
 $ fbodybodygyrojerkmag.std : num  -0.298 -0.644 -0.571 -0.53 -0.383 ...
